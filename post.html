<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>阅读文章</title>
    <style>
        body { max-width: 800px; margin: 20px auto; padding: 20px; font-family: sans-serif; line-height: 1.6; }
        .back { text-decoration: none; color: #0969da; display: inline-block; margin-bottom: 20px;}
        
        /* 文章容器 */
        #content { white-space: pre-wrap; font-family: sans-serif; }

        /* 文件下载按钮样式 */
        .file-card {
            background: #f6f8fa;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            padding: 10px 15px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .file-name { font-weight: bold; color: #24292f; }
        .file-download { color: #0969da; text-decoration: underline; cursor: pointer; font-size: 14px; }
        .file-download:hover { color: #0a3069; }
    </style>
</head>
<body>
    <a href="index.html" class="back">← 返回首页</a>
    <h1 id="title"></h1>
    <div id="content">加载中...</div>

    <script type="module">
        import { getPost, downloadFile } from "./js/api.js";
        const params = new URLSearchParams(location.search);
        const file = params.get("f");

        if(file) {
            document.getElementById("title").innerText = file;
            const text = await getPost(file);
            
            const contentDiv = document.getElementById("content");
            contentDiv.innerHTML = text; // 渲染 HTML (包括文件卡片)

            // 绑定下载按钮事件
            contentDiv.querySelectorAll('.file-download').forEach(btn => {
                btn.onclick = () => {
                    const path = btn.getAttribute('data-path');
                    downloadFile(path);
                };
            });
        } else {
            document.getElementById("content").innerText = "未找到文章";
        }
    </script>
</body>
</html>
